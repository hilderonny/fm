<md-card ng-cloak  ng-controller="AdministrationBPCardController"  style="background-image:url('/css/icons/office/Briefcase.svg');">

<md-card-title flex="none" class="withfab">
    <md-card-title-text>
        <span class = "md-headline" ng-hide ="isNewPartner">
            <span ng-bind= "partnerName"> </span>
        </span>
        <span class="md-headline" ng-if= "isNewPartner" translate>TRK_BP_NEWPARTNER </span>        
    </md-card-title-text>
</md-card-title>

<md-fab-speed-dial md-direction = "down" class="md-scale relations-anchor" ng-if="!isNewPartner">
    <md-fab-trigger>
        <md-button class ="md-fab md-accent" aria-label="MENU">
            <md-tooltip md-direction ="left">
                <span translate>TRK_BP_MORE_ACTIONS</span>
            </md-tooltip>
            <md-icon md-svg-src="/css/icons/material/Menu black.svg"> </md-icon>
        </md-button>
    </md-fab-trigger>

    <md-fab-actions>
        <md-button class ="md-fab md-raised md-mini" ng-click="addAddress()"  aria-label="ADD Address">
            <md-tooltip md-direction="left"> <span translate>TRK_BP_ADD_ADDRESS</span>
            </md-tooltip>
             <md-icon md-svg-src="/drafts/icons/Map Marker.svg"></md-icon>
        </md-button>       
            <ng-include src="'partial/Core/RelationsMenu.html'" ng-controller="CoreRelationsMenuController"></ng-include>
    </md-fab-actions>
</md-fab-speed-dial>

<md-button class="md-icon-button close" ng-click ="closeCard()" aria-label="CLOSE CARD">
    <md-icon md-svg-src="/css/icons/material/Delete.svg"></md-icon>
</md-button>

<script type ="text/ng-template" id ="PartnersFormTemplate">
    <md-card-content>
        <form name = "partnersForm" Layout ="column">

            <md-input-container flex>
                <label translate>TRK_BP_NAME </label>
                <input ng-model ="partner.name" name ="name">
             </md-input-container>

             <md-input-container flex ng-disabled="partnersForm.$invalid">
              <label translate>TRK_BP_INDUSTRY_NAME </label>
            <input ng-model ="partner.industry" name ="name">
            </md-input-container>

            <md-input-container flex ng-disabled="partnersForm.$invalid">
                <md-checkbox ng-model="partner.isJuristic"><span translate> TRK_BP_JURISTIC_PERSON</span></md-checkbox>
            </md-input-container>

            <md-input-container flex  ng-disabled="partnersForm.$invalid">
                 <label translate>TRK_BP_ROLE </label>
               <input ng-model ="partner.rolle" name ="name">
            </md-input-container>

             <md-card-actions layout = "row" layout-align="end center">
                 <md-button class="md-raised md-accent" ng-if="isNewPartner" ng-click="createPartner()" ng-disabled="partnersForm.$invalid">
                     <span translate>TRK_BP_CREATE </span>
                 </md-button>

                 <md-button class ="md-raised md-accent" ng-if="!isNewPartner" ng-click ="savePartner()" ng-disabled="partnersForm.$invalid">
                     <span translate>TRK_BP_SAVE</span>
                 </md-button>

                 <md-button class ="md-raised md-warn" ng-if="!isNewPartner" ng-click ="deletePartner()" ng-disabled="partnersForm.$invalid">
                     <span translate>TRK_BP_DELETE</span>
                 </md-button>

             </md-card-actions>
        </form>
    </md-card-content>
</script>

<md-tabs flex ng-if="!isNewPartner">
    <md-tab>
        <md-tab-label>
            <span translate>TRK_BP_DETAILS</span>            
        </md-tab-label>
        <md-tab-body>
        <ng-include src="'PartnersFormTemplate'"> </ng-include>    
        </md-tab-body>
    </md-tab>
    <md-tab>
        <md-tab-label><span translate>TRK_BP_ADDRESS</span>
    </md-tab-label>

        <md-tab-body >
            <md-list class="lines-between-items">
                <md-list-item ng-repeat="partnerAddress in partnerAddresses | orderBy:'street'" class="md-2-line" ng-click="selectBPAddress(partnerAddress)" ng-class="{active:selectedBPAddress == partnerAddress}">
                    <md-icon md-svg-src="{{partnerAddress.icon}}" ></md-icon>
                    <div class="md-list-item-text multiline">
                        <h3>{{partnerAddress.street}}</h3>
                        <p >{{partnerAddress.postcode}} {{partnerAddress.city}}</p>   
                    </div>
                    <md-divider ng-if="!$last"></md-divider>
                </md-list-item> 
            </md-list>
        </md-tab-body>
    </md-tab>
        <ng-include src="'partial/Core/RelationsTab.html'" ng-controller="CoreRelationsTabController"></ng-include>
</md-tabs>


<ng-include flex ng-if="isNewPartner" src="'PartnersFormTemplate'"></ng-include>

</md-card>